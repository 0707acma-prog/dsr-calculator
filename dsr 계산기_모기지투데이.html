<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 ì£¼íƒë‹´ë³´ëŒ€ì¶œ DSR ì •ë°€ ê³„ì‚°ê¸° (ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ ë°˜ì˜)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 35px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 26px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 14px;
            opacity: 0.95;
            margin-bottom: 5px;
        }

        .badge-container {
            margin-top: 15px;
        }

        .badge {
            display: inline-block;
            background: rgba(255,255,255,0.25);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 12px;
            margin: 0 5px;
        }

        .content {
            padding: 35px;
        }

        .section {
            margin-bottom: 35px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
        }

        .section-title .icon {
            font-size: 22px;
            margin-right: 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #444;
            margin-bottom: 10px;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 13px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
            font-family: inherit;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-addon {
            display: flex;
            align-items: stretch;
        }

        .input-addon input {
            border-radius: 10px 0 0 10px;
            flex: 1;
        }

        .input-addon .unit {
            background: #f5f5f5;
            padding: 13px 16px;
            border: 2px solid #e0e0e0;
            border-left: none;
            border-radius: 0 10px 10px 0;
            font-size: 14px;
            color: #666;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .korean-amount {
            font-size: 13px;
            color: #667eea;
            margin-top: 6px;
            font-weight: 600;
            min-height: 20px;
            padding-left: 4px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

        .info-badge {
            background: #e8f4fd;
            color: #1976d2;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            margin-top: 10px;
            line-height: 1.6;
            border-left: 4px solid #1976d2;
        }

        .calculate-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 19px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 25px;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .result {
            display: none;
            margin-top: 35px;
        }

        .result.show {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-title .icon {
            font-size: 26px;
            margin-right: 10px;
        }

        .result-main {
            background: rgba(255,255,255,0.2);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .result-main-label {
            font-size: 15px;
            opacity: 0.95;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .result-main-value {
            font-size: 38px;
            font-weight: 800;
            color: #fff200;
            margin-bottom: 8px;
        }

        .result-main-desc {
            font-size: 13px;
            opacity: 0.9;
            line-height: 1.8;
            white-space: pre-line;
        }

        .result-section {
            background: rgba(255,255,255,0.15);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .result-section-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.3);
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.15);
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-item-label {
            font-size: 14px;
            opacity: 0.95;
        }

        .result-item-value {
            font-size: 18px;
            font-weight: 700;
        }

        .stress-dsr-section {
            background: rgba(255,255,255,0.15);
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .stress-dsr-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .stress-dsr-title .icon {
            margin-right: 8px;
        }

        .stress-dsr-item {
            background: rgba(255,255,255,0.2);
            padding: 18px;
            border-radius: 8px;
            margin-bottom: 12px;
        }

        .stress-dsr-item:last-child {
            margin-bottom: 0;
        }

        .stress-dsr-item-title {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 10px;
            opacity: 0.95;
        }

        .stress-dsr-item-row {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            margin-bottom: 6px;
            line-height: 1.6;
        }

        .stress-dsr-item-row:last-child {
            margin-bottom: 0;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.2);
            font-weight: 700;
            font-size: 14px;
        }

        .info-box {
            background: #f8f9ff;
            padding: 25px;
            border-radius: 12px;
            border-left: 5px solid #667eea;
        }

        .info-box h3 {
            color: #667eea;
            font-size: 16px;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .info-box ul {
            list-style: none;
            font-size: 13px;
            color: #666;
            line-height: 1.8;
        }

        .info-box ul li:before {
            content: "âœ“ ";
            color: #667eea;
            font-weight: bold;
            margin-right: 8px;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: #555;
            color: #fff;
            text-align: left;
            border-radius: 8px;
            padding: 12px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            line-height: 1.6;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .help-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            font-size: 12px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .content {
                padding: 25px 20px;
            }

            .result-main-value {
                font-size: 30px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¦ ì£¼íƒë‹´ë³´ëŒ€ì¶œ DSR ì •ë°€ ê³„ì‚°ê¸°</h1>
            <p>2026ë…„ ìŠ¤íŠ¸ë ˆìŠ¤ DSR 3ë‹¨ê³„ - ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ë³„ ì°¨ë“± ì ìš©</p>
            <div class="badge-container">
                <span class="badge">ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ ë°˜ì˜</span>
                <span class="badge">í˜¼í•©í˜•Â·ì£¼ê¸°í˜• ì •ë°€ ê³„ì‚°</span>
                <span class="badge">2025ë…„ 7ì›” ê¸°ì¤€</span>
            </div>
        </div>

        <div class="content">
            <!-- ì†Œë“ ì •ë³´ -->
            <div class="section">
                <div class="section-title">
                    <span class="icon">ğŸ’°</span>
                    <span>ì†Œë“ ì •ë³´</span>
                </div>
                
                <div class="input-group">
                    <label for="annual-income">ì—°ì†Œë“ (ì„¸ì „)</label>
                    <div class="input-addon">
                        <input type="number" id="annual-income" placeholder="ì˜ˆ: 100000000" value="100000000" oninput="updateKoreanAmount(this, 'annual-income-kr')">
                        <span class="unit">ì›</span>
                    </div>
                    <div class="korean-amount" id="annual-income-kr">ì¼ì–µì›</div>
                </div>
            </div>

            <!-- ì‹ ê·œ ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì •ë³´ -->
            <div class="section">
                <div class="section-title">
                    <span class="icon">ğŸ </span>
                    <span>ì‹ ê·œ ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì •ë³´</span>
                </div>
                
                <div class="input-group">
                    <label for="loan-amount">ì£¼íƒë‹´ë³´ëŒ€ì¶œ ê¸ˆì•¡</label>
                    <div class="input-addon">
                        <input type="number" id="loan-amount" placeholder="ì˜ˆ: 300000000" value="300000000" oninput="updateKoreanAmount(this, 'loan-amount-kr')">
                        <span class="unit">ì›</span>
                    </div>
                    <div class="korean-amount" id="loan-amount-kr">ì‚¼ì–µì›</div>
                </div>

                <div class="grid-3">
                    <div class="input-group">
                        <label for="loan-period">ëŒ€ì¶œ ê¸°ê°„</label>
                        <select id="loan-period">
                            <option value="10">10ë…„</option>
                            <option value="15">15ë…„</option>
                            <option value="20">20ë…„</option>
                            <option value="25">25ë…„</option>
                            <option value="30" selected>30ë…„</option>
                            <option value="35">35ë…„</option>
                            <option value="40">40ë…„</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="loan-rate">ëŒ€ì¶œ ê¸ˆë¦¬</label>
                        <div class="input-addon">
                            <input type="number" id="loan-rate" placeholder="ì˜ˆ: 4.8" value="4.8" step="0.1">
                            <span class="unit">%</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="repayment-method">ìƒí™˜ ë°©ë²•</label>
                        <select id="repayment-method">
                            <option value="equal-payment">ì›ë¦¬ê¸ˆê· ë“±</option>
                            <option value="equal-principal" selected>ì›ê¸ˆê· ë“±</option>
                            <option value="maturity">ë§Œê¸°ì¼ì‹œ</option>
                        </select>
                    </div>
                </div>

                <div class="input-group">
                    <label for="loan-type">
                        ëŒ€ì¶œ ê¸ˆë¦¬ ìœ í˜•
                        <span class="tooltip">
                            <span class="help-icon">?</span>
                            <span class="tooltiptext">
                                <strong>ë³€ë™í˜•:</strong> ì „ ê¸°ê°„ ë³€ë™ê¸ˆë¦¬<br>
                                <strong>í˜¼í•©í˜•:</strong> ì¼ì • ê¸°ê°„ ê³ ì • í›„ ë³€ë™<br>
                                <strong>ì£¼ê¸°í˜•:</strong> ì¼ì • ì£¼ê¸°ë§ˆë‹¤ ê¸ˆë¦¬ ì¬ì¡°ì •<br>
                                ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ì— ë”°ë¼ ìŠ¤íŠ¸ë ˆìŠ¤ DSR ì ìš©ë¥ ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤.
                            </span>
                        </span>
                    </label>
                    <select id="loan-type" onchange="updateFixedPeriodOptions()">
                        <option value="variable">ë³€ë™í˜• (ì „ ê¸°ê°„ ë³€ë™ê¸ˆë¦¬)</option>
                        <option value="mixed">í˜¼í•©í˜• (ê³ ì •+ë³€ë™)</option>
                        <option value="periodic">ì£¼ê¸°í˜• (ì£¼ê¸°ë³„ ì¬ì¡°ì •)</option>
                    </select>
                </div>

                <div class="input-group" id="fixed-period-group" style="display: none;">
                    <label for="fixed-period">
                        ê³ ì •ê¸ˆë¦¬ ì ìš© ê¸°ê°„
                        <span class="tooltip">
                            <span class="help-icon">?</span>
                            <span class="tooltiptext">
                                í˜¼í•©í˜•/ì£¼ê¸°í˜• ëŒ€ì¶œì˜ ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ì…ë‹ˆë‹¤.<br>
                                <strong>5ë…„ ë¯¸ë§Œ:</strong> ìŠ¤íŠ¸ë ˆìŠ¤ ê¸ˆë¦¬ 100% ì ìš©<br>
                                <strong>5~9ë…„:</strong> 60~80% ì ìš© (í˜¼í•©í˜•), 30~40% ì ìš© (ì£¼ê¸°í˜•)<br>
                                <strong>9~21ë…„ ì´ìƒ:</strong> ë‹¨ê³„ë³„ ê°ë©´
                            </span>
                        </span>
                    </label>
                    <select id="fixed-period">
                        <option value="0">ê³ ì •ê¸ˆë¦¬ ë¯¸ì ìš© (ì „ ê¸°ê°„ ë³€ë™)</option>
                        <option value="3">3ë…„ ê³ ì •</option>
                        <option value="5">5ë…„ ê³ ì •</option>
                        <option value="7">7ë…„ ê³ ì •</option>
                        <option value="10">10ë…„ ê³ ì •</option>
                        <option value="12">12ë…„ ê³ ì •</option>
                        <option value="15">15ë…„ ê³ ì •</option>
                        <option value="18">18ë…„ ê³ ì •</option>
                        <option value="20">20ë…„ ê³ ì •</option>
                        <option value="25">25ë…„ ì´ìƒ ê³ ì •</option>
                    </select>
                    <div class="info-badge" id="fixed-period-info"></div>
                </div>

                <div class="input-group">
                    <label for="region-type">ë‹´ë³´ ì£¼íƒ ì†Œì¬ì§€</label>
                    <select id="region-type">
                        <option value="metro">ìˆ˜ë„ê¶Œ (ì„œìš¸/ê²½ê¸°/ì¸ì²œ)</option>
                        <option value="local">ë¹„ìˆ˜ë„ê¶Œ (ì§€ë°©)</option>
                    </select>
                </div>
            </div>

            <!-- ë³´ìœ  ëŒ€ì¶œ ì •ë³´ -->
            <div class="section">
                <div class="section-title">
                    <span class="icon">ğŸ“‹</span>
                    <span>ë³´ìœ  ëŒ€ì¶œ ì •ë³´</span>
                </div>
                
                <div class="grid-2">
                    <div class="input-group">
                        <label for="existing-interest">ë³´ìœ  ëŒ€ì¶œ ì—°ì´ì ìƒí™˜ì•¡</label>
                        <div class="input-addon">
                            <input type="number" id="existing-interest" placeholder="ì˜ˆ: 5000000" value="5000000" oninput="updateKoreanAmount(this, 'existing-interest-kr')">
                            <span class="unit">ì›</span>
                        </div>
                        <div class="korean-amount" id="existing-interest-kr">ì˜¤ë°±ë§Œì›</div>
                    </div>

                    <div class="input-group">
                        <label for="existing-principal">ë³´ìœ  ëŒ€ì¶œ ì—°ì›ê¸ˆ ìƒí™˜ì•¡</label>
                        <div class="input-addon">
                            <input type="number" id="existing-principal" placeholder="ì˜ˆ: 6100000" value="6100000" oninput="updateKoreanAmount(this, 'existing-principal-kr')">
                            <span class="unit">ì›</span>
                        </div>
                        <div class="korean-amount" id="existing-principal-kr">ìœ¡ë°±ì‹­ë§Œì›</div>
                    </div>
                </div>
            </div>

            <button class="calculate-btn" onclick="calculateDSR()">ğŸ¯ DSR ì •ë°€ ê³„ì‚°í•˜ê¸°</button>

            <!-- ê³„ì‚° ê²°ê³¼ -->
            <div class="result" id="result">
                <div class="result-box">
                    <div class="result-title">
                        <span class="icon">ğŸ“Š</span>
                        <span>DSR ê³„ì‚° ê²°ê³¼</span>
                    </div>
                    
                    <div class="result-main">
                        <div class="result-main-label">ê¸°ë³¸ DSR</div>
                        <div class="result-main-value" id="basic-dsr">0%</div>
                        <div class="result-main-desc" id="basic-dsr-desc"></div>
                    </div>

                    <div class="result-section">
                        <div class="result-section-title">ğŸ“‹ ìƒì„¸ ë‚´ì—­</div>
                        <div class="result-item">
                            <span class="result-item-label">ì—°ì†Œë“</span>
                            <span class="result-item-value" id="result-income">0ì›</span>
                        </div>
                        <div class="result-item">
                            <span class="result-item-label">ì‹ ê·œ ì£¼ë‹´ëŒ€ ì—°ì›ë¦¬ê¸ˆ</span>
                            <span class="result-item-value" id="result-new-payment">0ì›</span>
                        </div>
                        <div class="result-item">
                            <span class="result-item-label">ë³´ìœ  ëŒ€ì¶œ ì—°ì›ë¦¬ê¸ˆ</span>
                            <span class="result-item-value" id="result-existing-payment">0ì›</span>
                        </div>
                        <div class="result-item">
                            <span class="result-item-label">ì´ ì—°ì›ë¦¬ê¸ˆ ìƒí™˜ì•¡</span>
                            <span class="result-item-value" id="result-total-payment">0ì›</span>
                        </div>
                    </div>

                    <div class="stress-dsr-section" id="stress-dsr-section">
                        <div class="stress-dsr-title">
                            <span class="icon">âš¡</span>
                            <span>ìŠ¤íŠ¸ë ˆìŠ¤ DSR ì ìš© ê²°ê³¼</span>
                        </div>
                        <div id="stress-dsr-content"></div>
                    </div>
                </div>

                <div class="info-box">
                    <h3>ğŸ’¡ ìŠ¤íŠ¸ë ˆìŠ¤ DSR ì ìš© ê¸°ì¤€ (2025ë…„ 7ì›”)</h3>
                    <ul>
                        <li><strong>ë³€ë™í˜•:</strong> ìŠ¤íŠ¸ë ˆìŠ¤ ê¸ˆë¦¬ 3.0% (100% ì ìš©)</li>
                        <li><strong>í˜¼í•©í˜•:</strong> ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ì— ë”°ë¼ 60~100% ì°¨ë“± ì ìš©</li>
                        <li><strong>ì£¼ê¸°í˜•:</strong> ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ì— ë”°ë¼ 30~100% ì°¨ë“± ì ìš©</li>
                        <li>5ë…„ ë¯¸ë§Œ ê³ ì •: 100% ì ìš© / 5~9ë…„: 60~80% / 9~15ë…„: 40~60% / 15~21ë…„: 20~40% / 21ë…„ ì´ìƒ: ë¯¸ì ìš©</li>
                        <li>ì€í–‰ê¶Œ DSR í•œë„: 40% / ë³´í—˜ì‚¬ DSR í•œë„: 50%</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ìˆ«ìë¥¼ í•œê¸€ë¡œ ë³€í™˜
        function numberToKorean(num) {
            if (!num || num === 0) return '';
            
            const units = ['', 'ë§Œ', 'ì–µ', 'ì¡°'];
            const digits = ['', 'ì¼', 'ì´', 'ì‚¼', 'ì‚¬', 'ì˜¤', 'ìœ¡', 'ì¹ ', 'íŒ”', 'êµ¬'];
            
            let result = '';
            let unitIndex = 0;
            
            while (num > 0) {
                const part = num % 10000;
                if (part > 0) {
                    let partStr = '';
                    
                    const thousand = Math.floor(part / 1000);
                    const hundred = Math.floor((part % 1000) / 100);
                    const ten = Math.floor((part % 100) / 10);
                    const one = part % 10;
                    
                    if (thousand > 0) partStr += digits[thousand] + 'ì²œ';
                    if (hundred > 0) partStr += digits[hundred] + 'ë°±';
                    if (ten > 0) partStr += digits[ten] + 'ì‹­';
                    if (one > 0) partStr += digits[one];
                    
                    result = partStr + units[unitIndex] + (result ? ' ' : '') + result;
                }
                
                num = Math.floor(num / 10000);
                unitIndex++;
            }
            
            return result + 'ì›';
        }

        // ì‹¤ì‹œê°„ í•œê¸€ ê¸ˆì•¡ í‘œì‹œ
        function updateKoreanAmount(input, targetId) {
            const value = parseInt(input.value) || 0;
            const korean = numberToKorean(value);
            document.getElementById(targetId).textContent = korean;
        }

        // ìˆ«ì í¬ë§·íŒ…
        function formatNumber(num) {
            return Math.round(num).toLocaleString('ko-KR');
        }

        // ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ ì˜µì…˜ ì—…ë°ì´íŠ¸
        function updateFixedPeriodOptions() {
            const loanType = document.getElementById('loan-type').value;
            const fixedPeriodGroup = document.getElementById('fixed-period-group');
            
            if (loanType === 'mixed' || loanType === 'periodic') {
                fixedPeriodGroup.style.display = 'block';
                updateFixedPeriodInfo();
            } else {
                fixedPeriodGroup.style.display = 'none';
            }
        }

        // ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ ì •ë³´ ì—…ë°ì´íŠ¸
        function updateFixedPeriodInfo() {
            const loanType = document.getElementById('loan-type').value;
            const fixedPeriod = parseInt(document.getElementById('fixed-period').value);
            const infoDiv = document.getElementById('fixed-period-info');
            
            if (fixedPeriod === 0) {
                infoDiv.textContent = 'ì „ ê¸°ê°„ ë³€ë™ê¸ˆë¦¬ â†’ ìŠ¤íŠ¸ë ˆìŠ¤ ê¸ˆë¦¬ 100% ì ìš©';
                return;
            }

            let applyRate = 0;
            let category = '';

            if (fixedPeriod < 5) {
                applyRate = 100;
                category = '5ë…„ ë¯¸ë§Œ';
            } else if (fixedPeriod < 9) {
                applyRate = loanType === 'mixed' ? 80 : 40;
                category = '5~9ë…„';
            } else if (fixedPeriod < 15) {
                applyRate = loanType === 'mixed' ? 60 : 30;
                category = '9~15ë…„';
            } else if (fixedPeriod < 21) {
                applyRate = loanType === 'mixed' ? 40 : 20;
                category = '15~21ë…„';
            } else {
                applyRate = 0;
                category = '21ë…„ ì´ìƒ';
            }

            const typeKor = loanType === 'mixed' ? 'í˜¼í•©í˜•' : 'ì£¼ê¸°í˜•';
            
            if (applyRate === 0) {
                infoDiv.textContent = `${category} ê³ ì • â†’ ìŠ¤íŠ¸ë ˆìŠ¤ ê¸ˆë¦¬ ë¯¸ì ìš©`;
            } else {
                infoDiv.textContent = `${category} ê³ ì • â†’ ${typeKor} ìŠ¤íŠ¸ë ˆìŠ¤ ê¸ˆë¦¬ ${applyRate}% ì ìš©`;
            }
        }

        // ì›ë¦¬ê¸ˆê· ë“± ìƒí™˜
        function calculateEqualPayment(principal, annualRate, years) {
            const monthlyRate = annualRate / 100 / 12;
            const months = years * 12;
            
            if (monthlyRate === 0) {
                return principal / months;
            }
            
            const payment = principal * (monthlyRate * Math.pow(1 + monthlyRate, months)) / 
                           (Math.pow(1 + monthlyRate, months) - 1);
            return payment;
        }

        // ì›ê¸ˆê· ë“± ìƒí™˜
        function calculateEqualPrincipal(principal, annualRate, years) {
            const monthlyPrincipal = principal / (years * 12);
            const monthlyRate = annualRate / 100 / 12;
            
            const firstMonthInterest = principal * monthlyRate;
            const lastMonthInterest = monthlyPrincipal * monthlyRate;
            const avgMonthlyInterest = (firstMonthInterest + lastMonthInterest) / 2;
            
            const annualPayment = (monthlyPrincipal + avgMonthlyInterest) * 12;
            return annualPayment;
        }

        // ë§Œê¸°ì¼ì‹œ ìƒí™˜
        function calculateMaturity(principal, annualRate) {
            return principal * (annualRate / 100);
        }

        // ìŠ¤íŠ¸ë ˆìŠ¤ ê¸ˆë¦¬ ê³„ì‚°
        function getStressRate(loanType, fixedPeriod, regionType) {
            // ê¸°ì¤€ ìŠ¤íŠ¸ë ˆìŠ¤ ê¸ˆë¦¬ (2025ë…„ 7ì›” ê¸°ì¤€)
            const baseStressRate = 3.0;

            if (loanType === 'variable') {
                // ë³€ë™í˜•: 100% ì ìš©
                return baseStressRate;
            }

            // ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ì— ë”°ë¥¸ ì ìš© ë¹„ìœ¨
            let applyRatio = 1.0;

            if (fixedPeriod === 0) {
                // ê³ ì • ê¸°ê°„ ì—†ìŒ
                applyRatio = 1.0;
            } else if (fixedPeriod < 5) {
                // 5ë…„ ë¯¸ë§Œ
                applyRatio = 1.0;
            } else if (fixedPeriod < 9) {
                // 5~9ë…„
                applyRatio = loanType === 'mixed' ? 0.8 : 0.4;
            } else if (fixedPeriod < 15) {
                // 9~15ë…„
                applyRatio = loanType === 'mixed' ? 0.6 : 0.3;
            } else if (fixedPeriod < 21) {
                // 15~21ë…„
                applyRatio = loanType === 'mixed' ? 0.4 : 0.2;
            } else {
                // 21ë…„ ì´ìƒ
                applyRatio = 0.0;
            }

            return baseStressRate * applyRatio;
        }

        // DSR ê³„ì‚°
        function calculateDSR() {
            const annualIncome = parseFloat(document.getElementById('annual-income').value) || 0;
            const loanAmount = parseFloat(document.getElementById('loan-amount').value) || 0;
            const loanPeriod = parseInt(document.getElementById('loan-period').value) || 30;
            const loanRate = parseFloat(document.getElementById('loan-rate').value) || 0;
            const repaymentMethod = document.getElementById('repayment-method').value;
            const loanType = document.getElementById('loan-type').value;
            const fixedPeriod = parseInt(document.getElementById('fixed-period').value) || 0;
            const regionType = document.getElementById('region-type').value;
            const existingInterest = parseFloat(document.getElementById('existing-interest').value) || 0;
            const existingPrincipal = parseFloat(document.getElementById('existing-principal').value) || 0;

            if (annualIncome === 0) {
                alert('ì—°ì†Œë“ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (loanAmount === 0) {
                alert('ì£¼íƒë‹´ë³´ëŒ€ì¶œ ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ê¸°ë³¸ ì—°ì›ë¦¬ê¸ˆ ê³„ì‚°
            let annualNewPayment = 0;
            
            if (repaymentMethod === 'equal-payment') {
                const monthlyPayment = calculateEqualPayment(loanAmount, loanRate, loanPeriod);
                annualNewPayment = monthlyPayment * 12;
            } else if (repaymentMethod === 'equal-principal') {
                annualNewPayment = calculateEqualPrincipal(loanAmount, loanRate, loanPeriod);
            } else {
                annualNewPayment = calculateMaturity(loanAmount, loanRate);
            }

            const existingPayment = existingInterest + existingPrincipal;
            const totalPayment = annualNewPayment + existingPayment;
            const basicDSR = (totalPayment / annualIncome) * 100;

            // ê²°ê³¼ í‘œì‹œ
            document.getElementById('result').classList.add('show');
            document.getElementById('basic-dsr').textContent = basicDSR.toFixed(2) + '%';
            
            let repaymentMethodKor = '';
            if (repaymentMethod === 'equal-payment') repaymentMethodKor = 'ì›ë¦¬ê¸ˆê· ë“±';
            else if (repaymentMethod === 'equal-principal') repaymentMethodKor = 'ì›ê¸ˆê· ë“±';
            else repaymentMethodKor = 'ë§Œê¸°ì¼ì‹œ';
            
            document.getElementById('basic-dsr-desc').textContent = 
                `ì£¼íƒë‹´ë³´ëŒ€ì¶œ ${formatNumber(loanAmount)}ì›ì˜ ê²½ìš°\n` +
                `ì—°ì›ë¦¬ê¸ˆ ìƒí™˜ì•¡ì€ ${formatNumber(annualNewPayment)}ì›ì´ê³ \n` +
                `(${loanPeriod}ë…„, ${loanRate}%, ${repaymentMethodKor} ê¸°ì¤€)\n\n` +
                `ë³´ìœ í•˜ê³  ê³„ì‹  ëŒ€ì¶œì˜\n` +
                `ì—°ì›ë¦¬ê¸ˆ ìƒí™˜ì•¡ì€ ${formatNumber(existingPayment)}ì›ì…ë‹ˆë‹¤.\n\n` +
                `ì—°ì†Œë“ì€ ${formatNumber(annualIncome)}ì›ì´ë¯€ë¡œ\n` +
                `DSRì€ ì•½ ${basicDSR.toFixed(2)}%ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.`;

            document.getElementById('result-income').textContent = formatNumber(annualIncome) + 'ì›';
            document.getElementById('result-new-payment').textContent = formatNumber(annualNewPayment) + 'ì›';
            document.getElementById('result-existing-payment').textContent = formatNumber(existingPayment) + 'ì›';
            document.getElementById('result-total-payment').textContent = formatNumber(totalPayment) + 'ì›';

            // ìŠ¤íŠ¸ë ˆìŠ¤ DSR ê³„ì‚°
            const stressRate = getStressRate(loanType, fixedPeriod, regionType);
            const effectiveRate = loanRate + stressRate;

            let stressAnnualPayment = 0;
            if (repaymentMethod === 'equal-payment') {
                const monthlyPayment = calculateEqualPayment(loanAmount, effectiveRate, loanPeriod);
                stressAnnualPayment = monthlyPayment * 12;
            } else if (repaymentMethod === 'equal-principal') {
                stressAnnualPayment = calculateEqualPrincipal(loanAmount, effectiveRate, loanPeriod);
            } else {
                stressAnnualPayment = calculateMaturity(loanAmount, effectiveRate);
            }

            const stressTotalPayment = stressAnnualPayment + existingPayment;
            const stressDSR = (stressTotalPayment / annualIncome) * 100;

            let loanTypeKor = '';
            let fixedPeriodDesc = '';
            
            if (loanType === 'variable') {
                loanTypeKor = 'ë³€ë™í˜•';
                fixedPeriodDesc = 'ì „ ê¸°ê°„ ë³€ë™ê¸ˆë¦¬';
            } else if (loanType === 'mixed') {
                loanTypeKor = 'í˜¼í•©í˜•';
                if (fixedPeriod === 0) {
                    fixedPeriodDesc = 'ê³ ì • ê¸°ê°„ ì—†ìŒ (ì „ ê¸°ê°„ ë³€ë™)';
                } else if (fixedPeriod < 5) {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ê³ ì • (5ë…„ ë¯¸ë§Œ - 100% ì ìš©)`;
                } else if (fixedPeriod < 9) {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ê³ ì • (5~9ë…„ - 80% ì ìš©)`;
                } else if (fixedPeriod < 15) {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ê³ ì • (9~15ë…„ - 60% ì ìš©)`;
                } else if (fixedPeriod < 21) {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ê³ ì • (15~21ë…„ - 40% ì ìš©)`;
                } else {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ê³ ì • (21ë…„ ì´ìƒ - ë¯¸ì ìš©)`;
                }
            } else {
                loanTypeKor = 'ì£¼ê¸°í˜•';
                if (fixedPeriod === 0) {
                    fixedPeriodDesc = 'ê³ ì • ê¸°ê°„ ì—†ìŒ (ì „ ê¸°ê°„ ë³€ë™)';
                } else if (fixedPeriod < 5) {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ì£¼ê¸° (5ë…„ ë¯¸ë§Œ - 100% ì ìš©)`;
                } else if (fixedPeriod < 9) {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ì£¼ê¸° (5~9ë…„ - 40% ì ìš©)`;
                } else if (fixedPeriod < 15) {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ì£¼ê¸° (9~15ë…„ - 30% ì ìš©)`;
                } else if (fixedPeriod < 21) {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ì£¼ê¸° (15~21ë…„ - 20% ì ìš©)`;
                } else {
                    fixedPeriodDesc = `${fixedPeriod}ë…„ ì£¼ê¸° (21ë…„ ì´ìƒ - ë¯¸ì ìš©)`;
                }
            }

            const regionKor = regionType === 'metro' ? 'ìˆ˜ë„ê¶Œ' : 'ë¹„ìˆ˜ë„ê¶Œ';

            let stressDSRHtml = '';

            if (stressRate === 0) {
                stressDSRHtml = `
                    <div class="stress-dsr-item">
                        <div class="stress-dsr-item-title">ìŠ¤íŠ¸ë ˆìŠ¤ ê¸ˆë¦¬ ë¯¸ì ìš©</div>
                        <div style="font-size: 13px; opacity: 0.9; line-height: 1.6;">
                            ê³ ì •ê¸ˆë¦¬ ê¸°ê°„ì´ 21ë…„ ì´ìƒì´ë¯€ë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ DSRì´ ì ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>
                            ê¸°ë³¸ DSR ${basicDSR.toFixed(2)}%ê°€ ìµœì¢… DSRì…ë‹ˆë‹¤.
                        </div>
                    </div>
                `;
            } else {
                const applyPercent = ((stressRate / 3.0) * 100).toFixed(0);
                
                stressDSRHtml = `
                    <div class="stress-dsr-item">
                        <div class="stress-dsr-item-title">ìŠ¤íŠ¸ë ˆìŠ¤ DSR (${loanTypeKor}) ì ìš© ì‹œ</div>
                        <div style="font-size: 13px; opacity: 0.9; margin-bottom: 12px;">
                            ${fixedPeriodDesc}<br>
                            ë‹´ë³´ ì£¼íƒ ì†Œì¬ì§€: ${regionKor}
                        </div>
                        <div class="stress-dsr-item-row">
                            <span>ê¸°ì¤€ ëŒ€ì¶œ ê¸ˆë¦¬</span>
                            <span>${loanRate.toFixed(2)}%</span>
                        </div>
                        <div class="stress-dsr-item-row">
                            <span>ìŠ¤íŠ¸ë ˆìŠ¤ ê¸ˆë¦¬ (${applyPercent}% ì ìš©)</span>
                            <span>+ ${stressRate.toFixed(4)}%p</span>
                        </div>
                        <div class="stress-dsr-item-row">
                            <span>ì ìš© ê¸ˆë¦¬</span>
                            <span>${effectiveRate.toFixed(4)}%</span>
                        </div>
                        <div class="stress-dsr-item-row">
                            <span>ì—°ì›ë¦¬ê¸ˆ ìƒí™˜ì•¡</span>
                            <span>${formatNumber(stressAnnualPayment)}ì›</span>
                        </div>
                        <div class="stress-dsr-item-row">
                            <span>ì´ ì—°ì›ë¦¬ê¸ˆ ìƒí™˜ì•¡</span>
                            <span>${formatNumber(stressTotalPayment)}ì›</span>
                        </div>
                        <div class="stress-dsr-item-row">
                            <span>ìŠ¤íŠ¸ë ˆìŠ¤ DSR</span>
                            <span style="color: #fff200; font-size: 20px;">${stressDSR.toFixed(2)}%</span>
                        </div>
                    </div>
                `;
            }

            document.getElementById('stress-dsr-content').innerHTML = stressDSRHtml;
            document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ
        window.onload = function() {
            updateKoreanAmount(document.getElementById('annual-income'), 'annual-income-kr');
            updateKoreanAmount(document.getElementById('loan-amount'), 'loan-amount-kr');
            updateKoreanAmount(document.getElementById('existing-interest'), 'existing-interest-kr');
            updateKoreanAmount(document.getElementById('existing-principal'), 'existing-principal-kr');
            
            document.getElementById('fixed-period').addEventListener('change', updateFixedPeriodInfo);
        };
    </script>
</body>
</html>